project_name : "ae_gan_night"
experiment_path : "/home/vatsal/NWM/weatherforecasting/experiments/pretrained_ae_conv_disc"
experiment_name : "pretrained_ae_conv_disc"

autoencoder:
  down_block_types: ['DownEncoderBlock2D', 'DownEncoderBlock2D', 'DownEncoderBlock2D', 'DownEncoderBlock2D']
  in_channels: 1
  block_out_channels: [128, 256, 512, 512]  # downsample `len(block_out_channels) - 1` times
  act_fn: 'silu'
  latent_channels: 64
  up_block_types: ['UpDecoderBlock2D', 'UpDecoderBlock2D', 'UpDecoderBlock2D', 'UpDecoderBlock2D']
  norm_num_groups: 32
  layers_per_block: 2
  out_channels: 1

predictor:
  latent_dim: 512

lpips:
  disc_start: 0.2
  disc_weight: 1.0
  #disc opt
  disc_beta1: 0.5
  disc_beta2: 0.999
  #disc scheduler
  disc_start_lr: 5e-7
  disc_peak_lr: 5e-6
  disc_final_lr: 5e-8
  disc_warmup_ratio: 0.1
  #disc architecture
  disc_in_channels: 1
  disc_num_layers: 3
  use_actnorm: false
  #more losses
  perceptual_weight: 0.0
  kl_weight: 1e-6
  logvar_init: 0.0  

# dataset
dataset:
  name: sevir_lr
  seq_len: 1
  stride: 1
  batch_size: 8
  num_workers: 8

  input_frames: 0
  pred_frames: 1
  image_width: 128
  image_height: 128
  channels: 1

# optimizer
optim:
  lr : 5e-4
  weight_decay : 1e-3
  beta1: 0.9
  beta2: 0.999
  gradient_clip_val : 1.0

# lr scheduler
cosine_warmup:
  start_lr: 5e-5
  peak_lr: 5e-4
  final_lr: 5e-7
  warmup_ratio: 0.1

one_cycle:
  peak_lr : 1e-3
  start_lr: 4e-5
  final_lr: 4e-7
  rampup_ratio: 0.3

lr_range_test:
  max_lr: 1
  num_iter: 100

# trainer
trainer:
  devices: [1]
  max_epochs: 50
  accumulate_grad_batches: 1
  total_train_steps : -1 # need to be set
  total_val_steps : -1 # need to be set
  total_test_steps : -1 # need to be set
  save_every_n_steps: 0.01
  save_on_train_epoch_end: true
  limit_train_batches: 0.2
  limit_val_batches: 0.2
  limit_test_batches: 0.2
  log_every_n_steps: 1

# logging
logging:
  wandb_watch_log_freq: 0
  log_train_plots_n : 0.001
  log_val_plots_n : 0.001